{"ast":null,"code":"import { call, put, takeLeading } from 'redux-saga/effects';\nimport { REQUEST_ADD_NEW_COMMENT, REQUEST_ADD_NEW_POST, REQUEST_CHANGE_COMMENT, REQUEST_CHANGE_POST, REQUEST_DELETE_COMMENT, REQUEST_DELETE_POST, REQUEST_GET_CORRENT_POST } from '../actions/types';\nimport { addNewComment, addNewPost, changePost, deleteComment, deletePost, getCorrentPost, getPostsAll } from '../actions/post';\nimport { REQUEST_LOG_IN, REQUEST_GET_PROFILE, REQUEST_SIGN_IN } from '../actions/types';\nimport { APIlogIn, APIsignIn } from '../../API/auth/POST';\nimport { APIgetCorrentPost, APIgetPostsAll } from '../../API/posts/GET';\nimport { APIAddNewPost } from '../../API/posts/POST';\nimport { APIDeletePost } from '../../API/posts/DELETE';\nimport { APIChangePost } from '../../API/posts/PUT';\nimport { APIAddNewComment } from '../../API/comments/POST';\nimport { APIdeleteComment } from '../../API/comments/DELETE';\nimport { APIchangeComment } from '../../API/comments/PUT';\nimport { APIgetProfile } from '../../API/auth/GET';\nimport { removeError, setError } from '../actions/error';\nimport { signIn } from '../actions/user';\n\nconst delay = ms => new Promise(res => setTimeout(res, ms));\n\nexport function* sagaWatcher() {\n  yield takeLeading(REQUEST_SIGN_IN, sagaSignIn);\n  yield takeLeading(REQUEST_LOG_IN, sagaLogIn);\n  yield takeLeading(REQUEST_ADD_NEW_POST, sagaNewPostAdd);\n  yield takeLeading(REQUEST_DELETE_POST, sagaDeletePost);\n  yield takeLeading(REQUEST_CHANGE_POST, sagaChangePost);\n  yield takeLeading(REQUEST_ADD_NEW_COMMENT, sagaAddNewComment);\n  yield takeLeading(REQUEST_DELETE_COMMENT, sagaDeleteComment);\n  yield takeLeading(REQUEST_GET_CORRENT_POST, sagaGetCorrentPost);\n  yield takeLeading(REQUEST_CHANGE_COMMENT, sagaChangeComment);\n  yield takeLeading(REQUEST_GET_PROFILE, sageGetProfile);\n} //-----------------------------------------------------------//\n//---------- Настройка Всплывающего окна с ошибкой ----------//\n//-----------------------------------------------------------//\n\nfunction* showError(error) {\n  let timeOut = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1500;\n  yield put(setError(error));\n  yield delay(timeOut);\n  yield put(removeError());\n} //-----------------------------------------------------------//\n//--------------- Операции с ауентификацией -----------------//\n//-----------------------------------------------------------//\n//------ Вход, получение токена и постов ------ //\n\n\nfunction* sagaSignIn() {\n  try {\n    const payload = yield call(APIsignIn);\n    yield put(signIn(payload));\n    const response = yield call(APIgetPostsAll);\n    yield put(getPostsAll(response));\n  } catch (error) {\n    yield showError(error.response.data.message);\n  }\n} //------ Регистрация ------ //\n\n\nfunction* sagaLogIn() {\n  try {\n    yield call(APIlogIn);\n  } catch (error) {\n    yield showError('error');\n  }\n} //------ Если есть токен - Оставить пользователя залогиненым ------ //\n\n\nfunction* sageGetProfile() {\n  try {\n    const response = yield call(APIgetProfile);\n    const allPosts = yield call(APIgetPostsAll);\n    yield put(getPostsAll(allPosts));\n    yield put(signIn(response));\n  } catch (error) {\n    yield showError(error.response.data.message);\n  }\n} //-----------------------------------------------------------//\n//--------------- Операции с постами ------------------------//\n//-----------------------------------------------------------//\n//------ Добавить новый пост ------ //\n\n\nfunction* sagaNewPostAdd(action) {\n  try {\n    const payload = yield call(APIAddNewPost, action.payload);\n    yield put(addNewPost(payload));\n  } catch (error) {\n    console.log(error);\n    yield showError(error.response.data.message || `\n        что-то пошло не так\n    `);\n  }\n} //------ Удалить выбранный пост ------ //\n\n\nfunction* sagaDeletePost(action) {\n  try {\n    yield call(APIDeletePost, action.payload);\n    yield put(deletePost(action.payload));\n  } catch (error) {\n    yield showError(error.response.data.message);\n  }\n} //------ Изменить выбранный пост ------ //\n\n\nfunction* sagaChangePost(action) {\n  try {\n    const changedPost = yield call(APIChangePost, action.payload);\n    yield put(changePost(changedPost));\n  } catch (error) {\n    yield showError(error.response.data.message);\n  }\n} //------ Получить выбранный пост по id  ------ //\n\n\nfunction* sagaGetCorrentPost(action) {\n  try {\n    const postData = yield call(APIgetCorrentPost, action.payload);\n    yield put(getCorrentPost(postData));\n  } catch (error) {\n    yield showError(error.response.data.message || `\n      post Not Found\n      `);\n  }\n} //-----------------------------------------------------------//\n//--------------- Операции с комментариями ------------------//\n//-----------------------------------------------------------//\n//------ Добавить новый комментарий ------ //\n\n\nfunction* sagaAddNewComment(action) {\n  try {\n    const newPost = yield call(APIAddNewComment, action.payload);\n    yield put(addNewComment(newPost));\n  } catch (error) {\n    yield showError(error.response.data.message || `\n        Вы ввели слишком много символов!\n        Комментарий не будет опубликован\n    `);\n  }\n} //------ Удалить выбранный комментарий ------ //\n\n\nfunction* sagaDeleteComment(action) {\n  try {\n    yield call(APIdeleteComment, action.payload.commentId);\n    yield put(deleteComment(action.payload.commentId, action.payload.postId));\n  } catch (error) {\n    yield showError(error.response.data.message);\n  }\n} //------ Измененить комментарий  ------ //\n\n\nfunction* sagaChangeComment(action) {\n  try {\n    yield call(APIchangeComment, action.payload);\n  } catch (error) {\n    yield showError(error.response.data.message);\n  }\n}","map":{"version":3,"sources":["/home/dev/Desktop/socialFront/src/Redux/sagas/sagas.js"],"names":["call","put","takeLeading","REQUEST_ADD_NEW_COMMENT","REQUEST_ADD_NEW_POST","REQUEST_CHANGE_COMMENT","REQUEST_CHANGE_POST","REQUEST_DELETE_COMMENT","REQUEST_DELETE_POST","REQUEST_GET_CORRENT_POST","addNewComment","addNewPost","changePost","deleteComment","deletePost","getCorrentPost","getPostsAll","REQUEST_LOG_IN","REQUEST_GET_PROFILE","REQUEST_SIGN_IN","APIlogIn","APIsignIn","APIgetCorrentPost","APIgetPostsAll","APIAddNewPost","APIDeletePost","APIChangePost","APIAddNewComment","APIdeleteComment","APIchangeComment","APIgetProfile","removeError","setError","signIn","delay","ms","Promise","res","setTimeout","sagaWatcher","sagaSignIn","sagaLogIn","sagaNewPostAdd","sagaDeletePost","sagaChangePost","sagaAddNewComment","sagaDeleteComment","sagaGetCorrentPost","sagaChangeComment","sageGetProfile","showError","error","timeOut","payload","response","data","message","allPosts","action","console","log","changedPost","postData","newPost","commentId","postId"],"mappings":"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","sourcesContent":["import { call, put, takeLeading } from 'redux-saga/effects';\nimport {\n  REQUEST_ADD_NEW_COMMENT,\n  REQUEST_ADD_NEW_POST,\n  REQUEST_CHANGE_COMMENT,\n  REQUEST_CHANGE_POST,\n  REQUEST_DELETE_COMMENT,\n  REQUEST_DELETE_POST,\n  REQUEST_GET_CORRENT_POST,\n} from '../actions/types';\n\nimport {\n  addNewComment,\n  addNewPost,\n  changePost,\n  deleteComment,\n  deletePost,\n  getCorrentPost,\n  getPostsAll,\n} from '../actions/post';\n\nimport {\n  REQUEST_LOG_IN,\n  REQUEST_GET_PROFILE,\n  REQUEST_SIGN_IN,\n} from '../actions/types';\nimport { APIlogIn, APIsignIn } from '../../API/auth/POST';\nimport { APIgetCorrentPost, APIgetPostsAll } from '../../API/posts/GET';\nimport { APIAddNewPost } from '../../API/posts/POST';\nimport { APIDeletePost } from '../../API/posts/DELETE';\nimport { APIChangePost } from '../../API/posts/PUT';\nimport { APIAddNewComment } from '../../API/comments/POST';\nimport { APIdeleteComment } from '../../API/comments/DELETE';\nimport { APIchangeComment } from '../../API/comments/PUT';\nimport { APIgetProfile } from '../../API/auth/GET';\nimport { removeError, setError } from '../actions/error';\nimport { signIn } from '../actions/user';\n\nconst delay = (ms) => new Promise((res) => setTimeout(res, ms));\n\nexport function* sagaWatcher() {\n  yield takeLeading(REQUEST_SIGN_IN, sagaSignIn);\n  yield takeLeading(REQUEST_LOG_IN, sagaLogIn);\n  yield takeLeading(REQUEST_ADD_NEW_POST, sagaNewPostAdd);\n  yield takeLeading(REQUEST_DELETE_POST, sagaDeletePost);\n  yield takeLeading(REQUEST_CHANGE_POST, sagaChangePost);\n  yield takeLeading(REQUEST_ADD_NEW_COMMENT, sagaAddNewComment);\n  yield takeLeading(REQUEST_DELETE_COMMENT, sagaDeleteComment);\n  yield takeLeading(REQUEST_GET_CORRENT_POST, sagaGetCorrentPost);\n  yield takeLeading(REQUEST_CHANGE_COMMENT, sagaChangeComment);\n  yield takeLeading(REQUEST_GET_PROFILE, sageGetProfile);\n}\n//-----------------------------------------------------------//\n//---------- Настройка Всплывающего окна с ошибкой ----------//\n//-----------------------------------------------------------//\n\nfunction* showError(error, timeOut = 1500) {\n  yield put(setError(error));\n  yield delay(timeOut);\n  yield put(removeError());\n}\n\n//-----------------------------------------------------------//\n//--------------- Операции с ауентификацией -----------------//\n//-----------------------------------------------------------//\n\n//------ Вход, получение токена и постов ------ //\n\nfunction* sagaSignIn() {\n  try {\n    const payload = yield call(APIsignIn);\n    yield put(signIn(payload));\n    const response = yield call(APIgetPostsAll);\n    yield put(getPostsAll(response));\n  } catch (error) {\n    yield showError(error.response.data.message);\n  }\n}\n\n//------ Регистрация ------ //\n\nfunction* sagaLogIn() {\n  try {\n    yield call(APIlogIn);\n  } catch (error) {\n    yield showError('error');\n  }\n}\n\n//------ Если есть токен - Оставить пользователя залогиненым ------ //\n\nfunction* sageGetProfile() {\n  try {\n    const response = yield call(APIgetProfile);\n    const allPosts = yield call(APIgetPostsAll);\n    yield put(getPostsAll(allPosts));\n    yield put(signIn(response));\n  } catch (error) {\n    yield showError(error.response.data.message);\n  }\n}\n\n//-----------------------------------------------------------//\n//--------------- Операции с постами ------------------------//\n//-----------------------------------------------------------//\n\n//------ Добавить новый пост ------ //\n\nfunction* sagaNewPostAdd(action) {\n  try {\n    const payload = yield call(APIAddNewPost, action.payload);\n    yield put(addNewPost(payload));\n  } catch (error) {\n    console.log(error);\n    yield showError(\n      error.response.data.message ||\n        `\n        что-то пошло не так\n    `\n    );\n  }\n}\n\n//------ Удалить выбранный пост ------ //\n\nfunction* sagaDeletePost(action) {\n  try {\n    yield call(APIDeletePost, action.payload);\n    yield put(deletePost(action.payload));\n  } catch (error) {\n    yield showError(error.response.data.message);\n  }\n}\n\n//------ Изменить выбранный пост ------ //\n\nfunction* sagaChangePost(action) {\n  try {\n    const changedPost = yield call(APIChangePost, action.payload);\n    yield put(changePost(changedPost));\n  } catch (error) {\n    yield showError(error.response.data.message);\n  }\n}\n\n//------ Получить выбранный пост по id  ------ //\n\nfunction* sagaGetCorrentPost(action) {\n  try {\n    const postData = yield call(APIgetCorrentPost, action.payload);\n    yield put(getCorrentPost(postData));\n  } catch (error) {\n    yield showError(\n      error.response.data.message ||\n        `\n      post Not Found\n      `\n    );\n  }\n}\n\n//-----------------------------------------------------------//\n//--------------- Операции с комментариями ------------------//\n//-----------------------------------------------------------//\n\n//------ Добавить новый комментарий ------ //\n\nfunction* sagaAddNewComment(action) {\n  try {\n    const newPost = yield call(APIAddNewComment, action.payload);\n    yield put(addNewComment(newPost));\n  } catch (error) {\n    yield showError(\n      error.response.data.message ||\n        `\n        Вы ввели слишком много символов!\n        Комментарий не будет опубликован\n    `\n    );\n  }\n}\n\n//------ Удалить выбранный комментарий ------ //\n\nfunction* sagaDeleteComment(action) {\n  try {\n    yield call(APIdeleteComment, action.payload.commentId);\n    yield put(deleteComment(action.payload.commentId, action.payload.postId));\n  } catch (error) {\n    yield showError(error.response.data.message);\n  }\n}\n\n//------ Измененить комментарий  ------ //\n\nfunction* sagaChangeComment(action) {\n  try {\n    yield call(APIchangeComment, action.payload);\n  } catch (error) {\n    yield showError(error.response.data.message);\n  }\n}\n"]},"metadata":{},"sourceType":"module"}